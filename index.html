<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Happy Diwali — Special for Ranu 💖</title>
  <meta name="description" content="Happy Diwali wishes — personalized wish for Ranu, friends & festive animations. Built with love and code." />
  <meta name="theme-color" content="#fff2f5" />

  <!-- AOS (scroll animations) -->
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

  <style>
    /* ========== Reset & Base ========== */
    :root{
      --accent:#ff5b6b;
      --accent-2:#ff9a3f;
      --muted:#6b556a;
      --glass: rgba(255,255,255,0.9);
      --card-bg: linear-gradient(180deg, rgba(255,255,255,0.96), rgba(255,255,255,0.88));
      --max-width:1100px;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}
    body{
      font-family: 'Poppins', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: radial-gradient(circle at 10% 10%, #fff7f0 0%, #ffe6ef 18%, #ffdfe9 40%, #ffe6c9 100%);
      color:#222; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
      line-height:1.45;
    }
    a{color:inherit;text-decoration:none}
    img{display:block;max-width:100%}

    .site {
      max-width: var(--max-width);
      margin: 22px auto;
      padding: 0 18px 40px;
    }

    /* ========== Navbar ========== */
    .navbar {
      position: sticky;
      top: 14px;
      z-index: 120;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
      margin-bottom:18px;
      background: linear-gradient(180deg, rgba(255,255,255,0.88), rgba(255,255,255,0.82));
      padding: 10px 14px;
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(7,6,10,0.07);
      backdrop-filter: blur(6px);
      border: 1px solid rgba(255,92,107,0.06);
    }
    .brand {
      display:flex;align-items:center;gap:10px;
    }
    .logo {
      width:44px;height:44px;border-radius:10px;background:linear-gradient(45deg,var(--accent),var(--accent-2));
      display:flex;align-items:center;justify-content:center;color:white;font-weight:700;box-shadow:0 6px 20px rgba(255,90,120,0.12);
      font-size:18px;
    }
    .brand h4{font-size:1rem;margin:0;color:var(--muted)}
    .navlinks {
      display:flex;gap:8px;align-items:center;
    }
    .navlinks a{
      padding:8px 12px;border-radius:8px;font-weight:600;color:var(--muted);font-size:0.95rem;
    }
    .navlinks a.active, .navlinks a:hover{
      color: white;background: linear-gradient(45deg,var(--accent),var(--accent-2));
      box-shadow:0 8px 20px rgba(255,90,120,0.12);
    }

    /* hamburger - mobile */
    .menu-toggle { display:none; background:transparent;border:0;padding:6px;border-radius:8px;cursor:pointer }
    .menu-toggle:focus{outline:2px solid rgba(255,107,107,0.18)}
    .hamb {
      width:26px;height:16px;position:relative;
    }
    .hamb span{position:absolute;height:2px;background:#fff;left:0;right:0;border-radius:2px}
    .hamb span:nth-child(1){top:0;background:#8b6b7b}
    .hamb span:nth-child(2){top:7px;background:#8b6b7b}
    .hamb span:nth-child(3){top:14px;background:#8b6b7b}

    /* mobile menu */
    .mobile-menu {
      display:none;
      position: absolute;
      right: 12px;
      top: 64px;
      background: rgba(255,255,255,0.98);
      border-radius: 10px;
      box-shadow: 0 24px 50px rgba(7,6,10,0.12);
      padding:10px;
      min-width:180px;
      z-index:125;
    }
    .mobile-menu a{display:block;padding:10px;border-radius:8px;color:var(--muted);font-weight:600}
    .mobile-menu a:hover{background:linear-gradient(45deg,var(--accent),var(--accent-2));color:#fff}

    /* ========== Header ========== */
    header {
      background: linear-gradient(180deg, rgba(255,255,255,0.95), rgba(255,255,255,0.85));
      padding: 34px 20px;
      border-radius: 14px;
      box-shadow: 0 14px 45px rgba(3,3,8,0.10);
      text-align: left;
      position: relative;
      overflow: hidden;
    }
    header .head-grid{
      display:flex;gap:20px;align-items:center;justify-content:space-between;flex-wrap:wrap;
    }
    .hero {
      flex:1 1 520px;
    }
    .hero h1{ font-size: clamp(1.8rem, 5vw, 2.8rem); color:var(--accent); margin-bottom:8px; letter-spacing:0.4px}
    .hero p{ color:var(--muted); font-size:1.05rem; margin-bottom:14px }
    .hero .actions { display:flex; gap:10px; flex-wrap:wrap }
    .btn { background: linear-gradient(45deg,var(--accent),var(--accent-2)); color:white; padding:10px 16px; border-radius:12px; border:0; cursor:pointer; font-weight:700 }
    .btn.secondary { background: transparent; border:2px solid rgba(255,92,107,0.12); color:var(--muted); font-weight:700 }

    /* small features column */
    .features { width:260px; flex:0 0 260px; }
    .feature {
      background: var(--card-bg);
      border-radius:12px;padding:12px;margin-bottom:10px;box-shadow:0 10px 30px rgba(10,8,18,0.05);
      display:flex;gap:12px;align-items:center;
    }
    .feature .ico{width:48px;height:48px;border-radius:10px;background:linear-gradient(45deg,var(--accent),var(--accent-2));display:flex;align-items:center;justify-content:center;color:white;font-weight:800}
    .feature p{font-size:0.95rem;color:var(--muted);margin:0}

    /* ========== Main content cards (wishes) ========== */
    .main { display:grid; grid-template-columns: repeat(auto-fit,minmax(280px,1fr)); gap:20px; margin-top:22px }

    .card {
      background: var(--card-bg);
      padding:18px;border-radius:12px;box-shadow:0 10px 24px rgba(14,12,20,0.06);
      position:relative; overflow:visible;text-align:center;
    }
    .card h2{color:var(--accent); margin-bottom:8px}
    .card p{color:var(--muted); margin-bottom:10px}
    .card .gif{border-radius:8px;overflow:hidden;margin:10px 0}

    /* glow border */
    .card::after{
      content:""; position:absolute; inset:0;border-radius:12px;padding:2px;
      background:linear-gradient(120deg,var(--accent),#ffd36b,#ffd1f0,var(--accent));
      background-size:300% 300%;
      -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      -webkit-mask-composite: xor; animation: glow 6s linear infinite; pointer-events:none;
    }
    @keyframes glow{0%{background-position:0 50%}100%{background-position:100% 50%}}

    /* ========== About, Gallery, Contact ========== */
    section { margin-top:26px }
    .about-grid { display:grid; grid-template-columns:1fr 320px; gap:18px; align-items:start }
    .about { background:var(--card-bg); padding:18px;border-radius:12px }
    .gallery { display:grid; grid-template-columns:repeat(auto-fit,minmax(140px,1fr)); gap:10px }
    .gallery img{border-radius:8px; cursor:pointer; height:110px; object-fit:cover }

    /* lightbox */
    .lightbox {
      position:fixed; inset:0; display:flex;align-items:center;justify-content:center;background:rgba(5,5,8,0.7); z-index:200;
      padding:20px; opacity:0; pointer-events:none; transition:opacity .2s ease;
    }
    .lightbox.show{opacity:1; pointer-events:auto}
    .lightbox img{max-width:90%;max-height:80%;border-radius:10px;box-shadow:0 18px 60px rgba(0,0,0,0.5)}

    /* contact form */
    .contact-card { background:var(--card-bg); padding:18px;border-radius:12px }
    .field { display:flex; flex-direction:column; gap:6px; margin-bottom:10px }
    input[type="text"], input[type="email"], textarea {
      padding:10px;border-radius:8px;border:1px solid rgba(0,0,0,0.06); font-size:0.95rem;
      background:transparent;
    }
    textarea{min-height:120px; resize:vertical}
    .sr-only {position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}

    /* footer */
    footer{ text-align:center; margin-top:28px; color:var(--muted); font-size:0.95rem }

    /* ========== Decorations: diyas, emojis, modal (reused) ========== */
    .floating-diyas{ position:fixed; bottom:0; left:0; width:100%; height:0; pointer-events:none; z-index:6 }
    .diya{ position:absolute; width:64px; bottom:-120px; opacity:0.95; animation:diyaFloat linear infinite; transform-origin:center }
    .diya.d1{ left:6%; animation-duration:12s; animation-delay:0s }
    .diya.d2{ left:28%; animation-duration:14s; animation-delay:2s }
    .diya.d3{ left:50%; animation-duration:13s; animation-delay:1s }
    .diya.d4{ left:74%; animation-duration:15s; animation-delay:3s }
    @keyframes diyaFloat{0%{transform:translateY(0) rotate(0);opacity:1}100%{transform:translateY(-880px) rotate(360deg);opacity:0}}

    /* modal (Disha) */
    .modal-backdrop { position:fixed; inset:0; background:rgba(8,6,12,0.45); display:flex; align-items:center; justify-content:center; z-index:40; opacity:0; pointer-events:none; transition:opacity .25s ease }
    .modal { background: linear-gradient(180deg,#fff7f4,#fff1f0); border-radius:14px; padding:24px; width:min(640px,96%); box-shadow:0 18px 50px rgba(7,6,10,0.35); text-align:center; transform: translateY(8px); transition: transform .25s ease }
    .modal.show { transform:translateY(0) }
    .modal-backdrop.show { opacity:1; pointer-events:auto }

    .heart { width:110px;height:110px;margin:6px auto 6px; position:relative; animation:pulse 1.6s ease-in-out infinite }
    @keyframes pulse { 0%{transform:scale(1)} 50%{transform:scale(1.06)} 100%{transform:scale(1)} }

    .plead { position: fixed; bottom: 18px; left: 50%; transform: translateX(-50%); background: #fff4f8; padding: 12px 18px; border-radius: 14px; box-shadow: 0 10px 24px rgba(9,6,10,0.18); z-index: 60; display: none; border:1px solid rgba(196,59,106,0.12); font-weight:700; color:#b43b74 }

    .float-emoji { position:fixed; font-size:1.6rem; pointer-events:none; z-index:20 }

    /* big hero heart/confetti handled in JS */

    /* Responsive */
    @media (max-width:920px){
      .about-grid { grid-template-columns:1fr; }
      .features{display:none}
    }
    @media (max-width:760px){
      .navlinks{display:none}
      .menu-toggle{display:block}
    }

    /* focus states */
    a:focus, button:focus, input:focus, textarea:focus{ outline: 3px solid rgba(255,92,107,0.12); outline-offset:2px; border-radius:8px }

  </style>
</head>
<body>

  <!-- background audio (muted on some browsers until interaction) -->
  <audio id="bg-music" loop>
    <source src="https://cdn.pixabay.com/download/audio/2023/02/10/audio_8e0d2b6e67.mp3?filename=indian-festival-music-14031.mp3" type="audio/mp3">
  </audio>

  <div class="site">

    <!-- NAVBAR -->
    <nav class="navbar" role="navigation" aria-label="Main navigation">
      <div class="brand">
        <div class="logo" aria-hidden="true">PD</div>
        <div>
          <h4>Happy Diwali</h4>
          <div style="font-size:0.78rem;color:var(--muted)">By Pawan — Special for Ranu</div>
        </div>
      </div>

      <div class="navlinks" id="navLinks">
        <a href="#home" class="nav-link active">Home</a>
        <a href="#about" class="nav-link">About</a>
        <a href="#wishes" class="nav-link">Wishes</a>
        <a href="#gallery" class="nav-link">Gallery</a>
        <a href="#contact" class="nav-link">Contact</a>
      </div>

      <button class="menu-toggle" id="menuToggle" aria-expanded="false" aria-controls="mobileMenu" aria-label="Toggle menu">
        <div class="hamb" aria-hidden="true"><span></span><span></span><span></span></div>
      </button>

      <div class="mobile-menu" id="mobileMenu" aria-hidden="true">
        <a href="#home" class="mobile-link">Home</a>
        <a href="#about" class="mobile-link">About</a>
        <a href="#wishes" class="mobile-link">Wishes</a>
        <a href="#gallery" class="mobile-link">Gallery</a>
        <a href="#contact" class="mobile-link">Contact</a>
      </div>
    </nav>

    <!-- HEADER / HERO -->
    <header id="home" data-aos="zoom-in">
      <div class="head-grid">
        <div class="hero">
          <h1><span style="color:var(--accent)">Happy Diwali!</span> — Festival of Lights</h1>
          <p>Wishing Ranu a warm, joyful and sparkling Diwali. Light, love and code — sent from my heart. 🪔✨</p>
          <div class="actions">
            <button class="btn" onclick="openDishaModal()">For You Ranu 💖</button>
            <button class="btn secondary" onclick="document.querySelector('#wishes').scrollIntoView({behavior:'smooth'})">See Wishes</button>
          </div>
        </div>

        <aside class="features" aria-hidden="true">
          <div class="feature" data-aos="fade-left">
            <div class="ico">🎆</div>
            <p>Realistic fireworks & confetti for festival vibe.</p>
          </div>
          <div class="feature" data-aos="fade-left" data-aos-delay="80">
            <div class="ico">🪔</div>
            <p>Floating diyas & sparkles for a warm look.</p>
          </div>
          <div class="feature" data-aos="fade-left" data-aos-delay="140">
            <div class="ico">🎵</div>
            <p>Soft background music (toggleable) to set the tone.</p>
          </div>
        </aside>
      </div>
    </header>

    <!-- WISHES / MAIN -->
    <main id="wishes" class="main" aria-labelledby="wishesHeading">
      <h2 id="wishesHeading" class="sr-only">Wishes</h2>

      <!-- Friends Card -->
      <section class="card" data-aos="fade-up">
        <h2>Happy Diwali Mine Special Person</h2>
        <p>Ranu — khushiyan, success & dhersari masti bhari Diwali Ho tumhari! 🎉</p>
        <div class="gif"><img src="ranu.gif" alt="fireworks gif" loading="lazy"></div>
        <div style="margin:8px 0">🎆🪔🌟🎇</div>
        <button class="btn" onclick="toast('Sent wishes to friends ✨')">Send Group Wish</button>
      </section>

      <!-- Disha Card -->
      <section class="card" data-aos="zoom-in-up">
        <h2>For <span style="color:#a83b6f">Ranu</span> 💖</h2>
        <p>Ranu — tum Khud ek roshni ho. Tumhara chehra sada chamakta rahe. 🌹</p>
        <div class="gif"><img src="https://media.giphy.com/media/l0MYt5jPR6QX5pnqM/giphy.gif" alt="romantic gif" loading="lazy"></div>
        <div style="margin:8px 0">💕🕯️🌹</div>
        <div style="display:flex;gap:8px;justify-content:center">
          <button class="btn" onclick="openDishaModal()">Personal Wish</button>
          <button class="btn secondary" onclick="startFireworks(true)">Quick Fireworks</button>
        </div>
      </section>

      <!-- Animations -->
      <section class="card" data-aos="fade-up">
        <h2>Festive Animations</h2>
        <p>Tap animate — fireworks, emojis & diya lights will play. Enjoy! ✨</p>
        <div class="gif"><img src="https://media.giphy.com/media/26BRv0ThflsHCqDrG/giphy.gif" alt="lights gif" loading="lazy"></div>
        <div style="margin-top:8px; display:flex; gap:8px; justify-content:center">
          <button class="btn" onclick="startFireworks(true)">Animate!</button>
          <button class="btn secondary" onclick="toggleMusic()">Toggle Music</button>
        </div>
      </section>
    </main>

    <!-- ABOUT + Gallery -->
    <section id="about" data-aos="fade-up" class="about-grid" aria-labelledby="aboutHeading">
      <div class="about" aria-describedby="aboutText">
        <h3 id="aboutHeading" style="color:var(--accent)">About this e-card</h3>
        <p id="aboutText" style="color:var(--muted)">This single-page festive website is created as a heartfelt Diwali wish. It's built as a single HTML file for easy sharing — includes animations, responsive navbar, accessibility considerations and small interactive elements.</p>

        <div style="margin-top:12px" aria-hidden="true">
          <div style="font-size:0.95rem;color:var(--muted);margin-bottom:8px">Quick developer note</div>
          <div style="background:#111827;color:#e6eef8;padding:10px;border-radius:8px;font-family:monospace;font-size:0.9rem">
<small>// Save as index.html — works with internet connection (CDN images/scripts)</small>
          </div>
        </div>
      </div>

      <aside>
        <h4 style="color:var(--muted);margin-bottom:10px">Gallery</h4>
        <div id="gallery" class="gallery" aria-label="Gallery">
          <img src="https://images.unsplash.com/photo-1549576490-b0b4831ef60a?q=80&w=800&auto=format&fit=crop&sat=-30" alt="rangoli" loading="lazy" data-full="https://images.unsplash.com/photo-1549576490-b0b4831ef60a?q=80&w=1600&auto=format&fit=crop&sat=-30">
          <img src="https://images.unsplash.com/photo-1601924582975-3b9b9c9f8d80?q=80&w=800&auto=format&fit=crop&sat=-30" alt="diyas" loading="lazy" data-full="https://images.unsplash.com/photo-1601924582975-3b9b9c9f8d80?q=80&w=1600&auto=format&fit=crop&sat=-30">
          <img src="https://images.unsplash.com/photo-1519681393784-d120267933ba?q=80&w=800&auto=format&fit=crop&sat=-30" alt="fireworks photo" loading="lazy" data-full="https://images.unsplash.com/photo-1519681393784-d120267933ba?q=80&w=1600&auto=format&fit=crop&sat=-30">
          <img src="https://images.unsplash.com/photo-1504198453319-5ce911bafcde?q=80&w=800&auto=format&fit=crop&sat=-30" alt="lights street" loading="lazy" data-full="https://images.unsplash.com/photo-1504198453319-5ce911bafcde?q=80&w=1600&auto=format&fit=crop&sat=-30">
        </div>
      </aside>
    </section>

    <!-- Lightbox -->
    <div id="lightbox" class="lightbox" role="dialog" aria-hidden="true" tabindex="-1">
      <img src="" alt="Expanded image">
    </div>

    <!-- Contact -->
    <section id="contact" data-aos="fade-up" style="margin-top:18px">
      <div class="contact-card">
        <h3 style="color:var(--accent)">Contact / Share</h3>
        <p style="color:var(--muted)">Use the form to prepare a short message. (This demo doesn't send emails server-side; it opens your mail client.)</p>

        <form onsubmit="handleContact(event)" aria-label="Contact form">
          <div class="field">
            <label class="sr-only" for="name">Your name</label>
            <input id="name" type="text" placeholder="Your name" required>
          </div>
          <div class="field">
            <label class="sr-only" for="email">Your email</label>
            <input id="email" type="email" placeholder="Your email" required>
          </div>
          <div class="field">
            <label class="sr-only" for="message">Message</label>
            <textarea id="message" placeholder="Short message to Disha (or group)"></textarea>
          </div>
          <div style="display:flex;gap:10px;align-items:center">
            <button class="btn" type="submit">Prepare Email</button>
            <button type="button" class="btn secondary" onclick="copyLink()">Copy Page Link</button>
          </div>
        </form>
      </div>
    </section>

    <footer>
      Made With ❤️ By Er Pawan | Diwali Mubarak 🪔
    </footer>
  </div>

  <!-- Floating diyas -->
  <div class="floating-diyas" aria-hidden="true">
    <img class="diya d1" src="https://pngimg.com/uploads/diya/diya_PNG42.png" alt="">
    <img class="diya d2" src="https://pngimg.com/uploads/diya/diya_PNG43.png" alt="">
    <img class="diya d3" src="https://pngimg.com/uploads/diya/diya_PNG42.png" alt="">
    <img class="diya d4" src="https://pngimg.com/uploads/diya/diya_PNG43.png" alt="">
  </div>

  <!-- Disha Modal -->
  <div id="modalBackdrop" class="modal-backdrop" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div class="heart" aria-hidden="true">
        <svg viewBox="0 0 32 29" width="110" height="110" aria-hidden="true">
          <path d="M23.6 2.9c-2.6 0-4.9 1.4-6 3.5-1.1-2.1-3.4-3.5-6-3.5C6.7 2.9 4 5.6 4 9.1c0 6.1 12.4 12.8 12.8 13 0 0 .1 0 .1 0 .4-.2 12.7-6.9 12.7-13 0-3.4-2.8-6.2-7-6.2z" fill="#ff6b6b"/>
        </svg>
      </div>
      <h3 id="modalTitle" style="color:#c43b6a">Happy Diwali, Ranu! 💖</h3>
      <p>You are my light — will you be mine always?</p>
      <div class="actions" style="display:flex;gap:12px;justify-content:center;margin-top:12px">
        <button class="small btn-yes btn" style="border-radius:10px" onclick="dishaYes()">Yes 💕</button>
        <button class="small btn-no" style="border-radius:10px;background:#fff;border:2px solid #ffd6e1;color:#c43b6a" onclick="dishaNo()">No 😢</button>
      </div>
    </div>
  </div>

  <!-- Pleading message (for No) -->
  <div id="plead" class="plead">Please Ranu 🎀 Maan Jao Please 🙏!</div>

  <!-- emoji layer -->
  <div id="emojiLayer" aria-hidden="true"></div>

  <!-- Scripts: AOS, cursor effects, fireworks -->
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/cursor-effects@latest/dist/browser.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/fireworks-js@2/dist/fireworks.js"></script>

  <script>
    /* ===== Init AOS ===== */
    AOS.init({ duration: 800, once: true, easing:'ease-out-cubic' });

    /* ===== Cursor Sparkles (optional) ===== */
    try { new cursoreffects.sparkleCursor(); } catch(e){ /* ignore if blocked */ }

    /* ===== Music Control ===== */
    const music = document.getElementById('bg-music');
    let musicStarted = false;
    function toggleMusic(){
      if(!musicStarted){
        music.play().catch(()=>{ /* user interaction required */ });
        musicStarted = true;
      } else {
        if(music.paused) music.play(); else music.pause();
      }
    }

    /* ===== Toast ===== */
    function toast(msg){
      const el = document.createElement('div');
      el.textContent = msg;
      Object.assign(el.style, {
        position:'fixed',left:'50%',transform:'translateX(-50%)',bottom:'22px',
        background:'#fff',border:'1px solid rgba(0,0,0,0.06)',padding:'10px 14px',
        borderRadius:'12px',boxShadow:'0 12px 36px rgba(4,4,10,0.12)',zIndex:120,fontWeight:700
      });
      document.body.appendChild(el);
      setTimeout(()=> el.style.opacity = '0', 2000);
      setTimeout(()=> el.remove(), 2600);
    }

    /* ===== Fireworks control ===== */
    let fw = null;
    function startFireworks(auto=false){
      if(!fw){
        fw = new Fireworks(document.body, {
          hue: { min: 0, max: 360 },
          delay: { min: 8, max: 18 },
          rocketsPoint: 30,
          speed: 3,
          acceleration: 1.02,
          friction: 0.97,
          gravity: 1.2,
          particles: 70,
          traceLength: 3,
          explosion: 6,
          autoresize: true
        });
      }
      fw.start();
      if(auto) setTimeout(()=> { fw && fw.stop(); fw = null; }, 7000);
    }

    /* ===== Floating emojis generator ===== */
    const emojiList = ['🪔','✨','🎆','🌹','💖','🎇'];
    function spawnEmoji(){
      const e = document.createElement('div');
      e.className = 'float-emoji';
      e.textContent = emojiList[Math.floor(Math.random()*emojiList.length)];
      const size = 18 + Math.random()*26;
      e.style.fontSize = size + 'px';
      e.style.left = (Math.random()*90) + 'vw';
      e.style.bottom = '-6vh';
      document.body.appendChild(e);
      const duration = 4200 + Math.random()*2600;
      e.animate([{ transform: 'translateY(0) scale(1)', opacity:1 }, { transform: `translateY(-110vh) scale(${0.9 + Math.random()*0.3}) rotate(${Math.random()*360}deg)`, opacity:0 }], { duration, easing: 'linear' });
      setTimeout(()=> e.remove(), duration + 80);
    }
    let emojiInterval = setInterval(spawnEmoji, 800);

    /* ===== Modal logic (Disha) ===== */
    const backdrop = document.getElementById('modalBackdrop');
    const plead = document.getElementById('plead');

    function openDishaModal(){
      backdrop.classList.add('show');
      backdrop.setAttribute('aria-hidden','false');
      if(!musicStarted){ music.play().catch(()=>{}); musicStarted = true; }
      const heart = document.querySelector('.heart svg path');
      heart && heart.animate([{ transform: 'scale(1)' }, { transform:'scale(1.05)' }, { transform:'scale(1)' }], { duration: 900 });
    }
    function closeDishaModal(){ backdrop.classList.remove('show'); backdrop.setAttribute('aria-hidden','true'); }

    function dishaYes(){
      closeDishaModal();
      showBigHeartConfetti();
      toast("She said YES! 💘");
    }
    function dishaNo(){
      closeDishaModal();
      plead.style.display = 'block';
      plead.animate([{ transform:'translateY(10px)', opacity:0 }, { transform:'translateY(0)', opacity:1 }], { duration:260, easing:'ease-out' });
      setTimeout(()=> {
        plead.animate([{ opacity:1 }, { opacity:0 }], { duration:600 });
        setTimeout(()=> plead.style.display='none', 620);
      }, 3600);
      const h = document.querySelector('header');
      h && h.animate([{ transform:'translateX(0)' }, { transform:'translateX(-6px)' }, { transform:'translateX(6px)' }, { transform:'translateX(0)' }], { duration:700 });
    }

    backdrop.addEventListener('click', (e) => { if(e.target === backdrop) closeDishaModal(); });

    function showBigHeartConfetti(){
      const heartBox = document.createElement('div');
      Object.assign(heartBox.style, { position:'fixed', left:'50%', top:'45%', transform:'translate(-50%,-50%)', zIndex:100, pointerEvents:'none' });
      heartBox.innerHTML = `<svg width="240" height="240" viewBox="0 0 32 29"><path d="M23.6 2.9c-2.6 0-4.9 1.4-6 3.5-1.1-2.1-3.4-3.5-6-3.5C6.7 2.9 4 5.6 4 9.1c0 6.1 12.4 12.8 12.8 13 0 0 .1 0 .1 0 .4-.2 12.7-6.9 12.7-13 0-3.4-2.8-6.2-7-6.2z" fill="#ff6b6b"/></svg>`;
      document.body.appendChild(heartBox);
      heartBox.animate([{ transform:'translate(-50%,-50%) scale(0.6)', opacity:0 }, { transform:'translate(-50%,-50%) scale(1.02)', opacity:1 }, { transform:'translate(-50%,-50%) scale(0.95)', opacity:1 }, { opacity: 0 }], { duration:2400, easing:'ease-out' });
      setTimeout(()=> heartBox.remove(), 2500);

      const colors = ['#ff6b6b','#ffd36b','#ff86a8','#8be6ff','#ffd6e1'];
      for(let i=0;i<50;i++){
        const p = document.createElement('div');
        p.style.position='fixed';
        p.style.left = (40 + Math.random()*20) + '%';
        p.style.top = (40 + Math.random()*20) + '%';
        p.style.width = p.style.height = (6 + Math.random()*10) + 'px';
        p.style.background = colors[Math.floor(Math.random()*colors.length)];
        p.style.borderRadius = (Math.random()>0.6? '3px':'50%');
        p.style.zIndex = 95; p.style.pointerEvents='none';
        document.body.appendChild(p);
        const dx = (Math.random()-0.5)*1400;
        const dy = -800 - Math.random()*600;
        p.animate([{ transform:'translate(0,0) rotate(0deg)', opacity:1 }, { transform:`translate(${dx}px, ${dy}px) rotate(${Math.random()*720}deg)`, opacity:0 }], { duration:1400 + Math.random()*900, easing:'cubic-bezier(.2,.8,.2,1)' });
        setTimeout(()=> p.remove(), 2600);
      }
    }

    /* ===== Start fireworks/music on first interaction for autoplay policies ===== */
    let fireworksStarted = false;
    function startFireworksOnInteraction(){
      if(fireworksStarted) return;
      fireworksStarted = true;
      startFireworks(false);
      setTimeout(()=> { if(fw){ fw.stop(); fw=null; fireworksStarted=false } }, 9000);
    }
    ['click','touchstart','mousemove','keydown'].forEach(evt => {
      window.addEventListener(evt, function onceStart(){
        startFireworksOnInteraction();
        if(!musicStarted){ music.play().catch(()=>{}); musicStarted = true; }
        window.removeEventListener(evt, onceStart);
      }, { once: true });
    });

    /* ===== Gallery Lightbox ===== */
    const galleryImgs = document.querySelectorAll('#gallery img');
    const lightbox = document.getElementById('lightbox');
    const lightboxImg = lightbox.querySelector('img');
    galleryImgs.forEach(img => {
      img.addEventListener('click', () => {
        const full = img.getAttribute('data-full') || img.src;
        lightboxImg.src = full;
        lightbox.classList.add('show');
        lightbox.setAttribute('aria-hidden','false');
        lightbox.focus();
      });
    });
    lightbox.addEventListener('click', (e) => {
      if(e.target === lightbox || e.target === lightboxImg) {
        lightbox.classList.remove('show'); lightbox.setAttribute('aria-hidden','true');
      }
    });
    window.addEventListener('keydown', e => { if(e.key==='Escape'){ lightbox.classList.remove('show'); lightbox.setAttribute('aria-hidden','true'); closeDishaModal(); } });

    /* ===== Contact handler (opens mail client) ===== */
    function handleContact(e){
      e.preventDefault();
      const name = document.getElementById('name').value || 'Friend';
      const email = document.getElementById('email').value || '';
      const msg = document.getElementById('message').value || `Happy Diwali!`;
      const subject = encodeURIComponent('Happy Diwali Wishes');
      const body = encodeURIComponent(`Hi Disha,\n\n${msg}\n\n— ${name}${email ? ' ('+email+')' : ''}`);
      window.location.href = `mailto:?subject=${subject}&body=${body}`;
    }

    /* ===== Copy link ===== */
    function copyLink(){
      navigator.clipboard?.writeText(location.href).then(()=> toast('Page link copied ✅')).catch(()=> toast('Could not copy — please copy manually'));
    }

    /* ===== Navbar mobile toggle & smooth scroll & active links ===== */
    const menuToggle = document.getElementById('menuToggle');
    const mobileMenu = document.getElementById('mobileMenu');
    menuToggle.addEventListener('click', () => {
      const open = mobileMenu.style.display === 'block';
      mobileMenu.style.display = open ? 'none' : 'block';
      menuToggle.setAttribute('aria-expanded', (!open).toString());
      mobileMenu.setAttribute('aria-hidden', open ? 'true' : 'false');
    });
    // close mobile menu on link click
    document.querySelectorAll('.mobile-link').forEach(link => link.addEventListener('click', ()=> mobileMenu.style.display = 'none'));

    // smooth scroll for nav
    document.querySelectorAll('.nav-link, .mobile-link').forEach(link => {
      link.addEventListener('click', (ev) => {
        ev.preventDefault();
        const href = link.getAttribute('href');
        const target = document.querySelector(href);
        if(target) target.scrollIntoView({behavior:'smooth', block:'start'});
        // update active class for desktop nav
        document.querySelectorAll('.nav-link').forEach(n => n.classList.remove('active'));
        const desktopLink = document.querySelector('.nav-link[href="'+href+'"]');
        desktopLink && desktopLink.classList.add('active');
      });
    });

    // active section observer
    const sections = document.querySelectorAll('main, section, header');
    const navLinks = document.querySelectorAll('.nav-link');
    const io = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if(entry.isIntersecting){
          const id = entry.target.id || '#home';
          navLinks.forEach(n => n.classList.toggle('active', n.getAttribute('href') === '#'+id));
        }
      });
    }, { root: null, rootMargin: '-40% 0px -40% 0px', threshold: 0 });
    // observe specific elements
    ['home','about','wishes','gallery','contact'].forEach(id => {
      const el = document.getElementById(id);
      if(el) io.observe(el);
    });

    /* ===== Cursor sparkles optional init handled above ===== */

    /* ===== Cleanup before unload ===== */
    window.addEventListener('beforeunload', () => { try{ if(fw) fw.stop(); } catch(e){} });

  </script>
</body>
</html>
